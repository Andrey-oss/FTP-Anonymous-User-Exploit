from ftplib import FTP
import time
import ftplib
import readline

host = input ("Remote host: ")
port = input ("Remote port: ")

print ("[\x1B[32m+\x1B[37m] Connecting to the FTP Server")

try:
   ftp = FTP(host)
   ftp.connect(host=host, port=int(port))
except:
   print ("[\x1B[31m-\x1B[37m] Host or port invalid!")
   exit()

print ("[\x1B[32m+\x1B[37m] Connected to the FTP Server!")
print ("")
print ("[\x1B[32m+\x1B[37m]                       Basic information                       [\x1B[32m+\x1B[37m] ")
print ("--------------------------------------------------------------------")
print ("")
print (ftp.getwelcome())
print ("")
print ("--------------------------------------------------------------------")
print ("")
try:
   print ("[\x1B[32m+\x1B[37m] Trying to login anonymous")
   login = ftp.login()
except:
   print ("[\x1B[31m-\x1B[37m] User cannot be logged in")
   exit()

login = ftp.login()

if login == "230 Anonymous user logged in":
   print ("[\x1B[32m+\x1B[37m] Logged in Anonymous user!")
   print ("[\x1B[32m+\x1B[37m] Spawning shell")
   print ("")
   time.sleep(1)

while True:
      line = input("FTP-Shell:> ")
      liner = line.split()

      try:
         if liner[0] == 'exit':
            print ("Goodbye")
            break

         elif liner[0] == 'delete' or liner[0] == 'del':
            try:
               ftp.delete(liner[1])
               print ("[\x1B[32m+\x1B[37m] Command received successfully!")
            except ftplib.error_perm as e:
               print ("[\x1B[31m-\x1B[37m]"+e)

         elif liner[0] == 'dir' or liner[0] == 'ls':
            ftp.dir()

         elif liner[0] == 'cd':
            try:
               ftp.cwd(liner[1])
               print ("[\x1B[32m+\x1B[37m] Command received successfully!")
            except Exception:
               print ("[\x1B[31m-\x1B[37m] Permission denied or its not file")

         elif liner[0] == 'pwd':
               print ("Current directory - "+str(ftp.pwd()))

         elif liner[0] == 'rename':
               try:
                  ftp.rename(liner[1], liner[2])
                  print ("[\x1B[32m+\x1B[37m] Command received successfully!")
               except ftplib.error_perm as e:
                  print ("[\x1B[31m-\x1B[37m]"+e)

         elif liner[0] == 'help':
            print ("")
            print ("FTP-Shell - Simple FTP client made by Andreyoss for Anonymous FTP Vulnerability")
            print ("")
            print ("cd <remote-folder> - Change folder")
            print ("dir/ls - List of all dirs/files in your folder")
            print ("delete/del <remote-file> - Delete file/folder")
            print ("help - Help reference")
            print ("exit - Goodbye :)")
            print ("pwd - Path to your folder")
            print ("rename <fromname> <toname> - Rename file")
            print ("")

         else:
            print ("[\x1B[31m-\x1B[37m] Invalid command")

      except Exception:
        pass

else:
   print ("[\x1B[31m-\x1B[37m] User cannot be logged in")
   exit()
